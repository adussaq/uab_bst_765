!function(){var e={};e.RELAXED=!1,e.IGNORE_RECORD_LENGTH=!1,e.IGNORE_QUOTES=!1,e.LINE_FEED_OK=!0,e.CARRIAGE_RETURN_OK=!0,e.DETECT_TYPES=!0,e.IGNORE_QUOTE_WHITESPACE=!0,e.DEBUG=!1,e.ERROR_EOF="UNEXPECTED_END_OF_FILE",e.ERROR_CHAR="UNEXPECTED_CHARACTER",e.ERROR_EOL="UNEXPECTED_END_OF_RECORD",e.WARN_SPACE="UNEXPECTED_WHITESPACE";var n='"',t="\r",r="\n",o=",",E=" ",d="	",u=0,c=1,s=2,_=4;e.parse=function(_){var R=e.result=[];e.offset=0,e.str=_,e.record_begin(),e.debug("parse()",_);for(var f;;){if(f=_[e.offset++],e.debug("c",f),null==f){e.escaped&&e.error(e.ERROR_EOF),e.record&&(e.token_end(),e.record_end()),e.debug("...bail",f,e.state,e.record),e.reset();break}if(null==e.record){if(e.RELAXED&&(f==r||f==t&&_[e.offset+1]==r))continue;e.record_begin()}if(e.state==u){if((f===E||f===d)&&e.next_nonspace()==n){if(e.RELAXED||e.IGNORE_QUOTE_WHITESPACE)continue;e.warn(e.WARN_SPACE)}if(f==n&&!e.IGNORE_QUOTES){e.debug("...escaped start",f),e.escaped=!0,e.state=c;continue}e.state=c}e.state==c&&e.escaped?f==n?_[e.offset]==n?(e.debug("...escaped quote",f),e.token+=n,e.offset++):(e.debug("...escaped end",f),e.escaped=!1,e.state=s):(e.token+=f,e.debug("...escaped add",f,e.token)):f==t?(_[e.offset]==r?e.offset++:e.CARRIAGE_RETURN_OK||e.error(e.ERROR_CHAR),e.token_end(),e.record_end()):f==r?(e.LINE_FEED_OK||e.RELAXED||e.error(e.ERROR_CHAR),e.token_end(),e.record_end()):f==o?e.token_end():e.state==c?(e.token+=f,e.debug("...add",f,e.token)):f===E||f===d?e.IGNORE_QUOTE_WHITESPACE||e.error(e.WARN_SPACE):e.RELAXED||e.error(e.ERROR_CHAR)}return R},e.reset=function(){e.state=null,e.token=null,e.escaped=null,e.record=null,e.offset=null,e.result=null,e.str=null},e.next_nonspace=function(){for(var n,t=e.offset;t<e.str.length;)if(n=e.str[t++],n!=E&&n!==d)return n;return null},e.record_begin=function(){e.escaped=!1,e.record=[],e.token_begin(),e.debug("record_begin")},e.record_end=function(){e.state=_,!e.IGNORE_RECORD_LENGTH&&!e.RELAXED&&e.result.length>0&&e.record.length!=e.result[0].length&&e.error(e.ERROR_EOL),e.result.push(e.record),e.debug("record end",e.record),e.record=null},e.resolve_type=function(e){return e.match(/^\d+(\.\d+)?$/)?e=parseFloat(e):e.match(/^true|false$/i)?e=Boolean(e.match(/true/i)):"undefined"===e?e=void 0:"null"===e&&(e=null),e},e.token_begin=function(){e.state=u,e.token=""},e.token_end=function(){e.DETECT_TYPES&&(e.token=e.resolve_type(e.token)),e.record.push(e.token),e.debug("token end",e.token),e.token_begin()},e.debug=function(){e.DEBUG&&console.log(arguments)},e.dump=function(n){return[n,"at char",e.offset,":",e.str.substr(e.offset-50,50).replace(/\r/gm,"\\r").replace(/\n/gm,"\\n").replace(/\t/gm,"\\t")].join(" ")},e.error=function(n){var t=e.dump(n);throw e.reset(),t},e.warn=function(n){var t=e.dump(n);try{return void console.warn(t)}catch(r){}try{console.log(t)}catch(r){}},function(e,n,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define(t):this[e]=t()}("CSV",this,function(){return e})}();